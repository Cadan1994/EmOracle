CREATE OR REPLACE FUNCTION IMPLANTACAO.CADAN_BSC_VENDA_PF(VRSEQPESSOA IN GE_PESSOA.SEQPESSOA%TYPE)
/*
Alterado em 06/09/2022 por Hilson Santos
Colocando todas as vendas no c√≥digo "CGO" 307
*/
RETURN NUMBER
IS

RESULT NUMBER;
REC_CLIENTE INTEGER;
VLR_VENDAS NUMBER;

BEGIN
     SELECT SUM(ROUND(VLRITEM, 2)) 
     INTO   VLR_VENDAS
     FROM   IMPLANTACAO.MAXV_ABCDISTRIBBASE
     WHERE  1=1
     AND    SEQPESSOA = VRSEQPESSOA
     AND    DTAHORLANCTO BETWEEN TRUNC(SYSDATE,'MM') AND TRUNC(SYSDATE,'DD') + 1
     AND    CODGERALOPER = 307
     GROUP  BY REC_CLIENTE;

     RESULT:= VLR_VENDAS; 

     RETURN(RESULT);
END;
